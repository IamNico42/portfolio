---
created:
  - "{{date: DD-MM-YYYY}} {{time}}"
aliases:
  - "Course Code:"
  - PSS-Portswigger-Academy
tags:
  - Course/
---
## ğŸ”§ Manipulation von WebSocket Traffic (mit Burp Suite)

**Ziel:** Schwachstellen finden, indem man WebSocket-Verkehr so verÃ¤ndert, wie es die Anwendung nicht erwartet.

#### 1. Abfangen & Modifizieren von Nachrichten
- In Burp **Proxy aktivieren**.
- Anwendung im Burp-Browser Ã¶ffnen â†’ im Tab _WebSockets history_ sieht man die Nachrichten.
- Nachrichten kÃ¶nnen im _Intercept_-Tab abgefangen, verÃ¤ndert und dann mit **Forward** weitergeleitet werden.
- Man kann einstellen, ob **Client â†’ Server** oder **Server â†’ Client** Nachrichten abgefangen werden.
    

#### 2. Nachrichten wiederholen & neu erzeugen

- Mit **Send to Repeater** einzelne Nachrichten in den Repeater schicken.
- Dort kann man:
    - Nachrichten beliebig **Ã¤ndern und erneut senden**.
    - **Neue Nachrichten** erstellen (in beide Richtungen).
    - Den Verlauf aller Nachrichten einsehen und beliebige erneut bearbeiten und senden.
        

#### 3. Manipulation der WebSocket-Verbindung (Handshake)

- Manchmal muss der **Handshake** selbst manipuliert werden (z. B. um mehr AngriffsflÃ¤che zu erreichen, neue Tokens zu verwenden oder eine getrennte Verbindung neu aufzubauen).
- Im Burp Repeater:
    - Auf das **Stift-Symbol** neben der WebSocket-URL klicken â†’ Wizard Ã¶ffnet sich.
    - MÃ¶glichkeiten: bestehende Verbindung anhÃ¤ngen, klonen oder eine getrennte neu aufbauen.
    - Handshake-Details kÃ¶nnen **bearbeitet** werden, bevor die Verbindung ausgefÃ¼hrt wird.
    - Bei Erfolg kann man Ã¼ber die neue Verbindung weitere Nachrichten senden.


### ğŸ–¥ï¸ğŸ§ªLab: Manipulating WebSocket messages to exploit vulnerabilities

To solve the lab, use a WebSocket message to trigger anÂ `alert()`Â popup in the support agent's browser.

1. Live-Chat starten
2. Nachricht schicken und im intercept schauen wie die verarbeitet werden 
	- Client schickt: `<img src=1 onerror='alert(1)'>`
	- Client to Server: 
```
{"message":"&lt;img src=1 onerror=&#39;alert(1)&#39;&gt;&#x0a;"}
```
	- Server to Client 
```
{"user":"You",
"content":"<img src=1 onerror='alert(1)'>"}
```

Daran sehen wir der Client wandelt das Image in einen String um. Daher intercepten wir die Anfrage Client To Server und Ã¤ndern den Inhalt.
Nachdem die Anfrage intercepted und geÃ¤ndert wurde lÃ¤dt das Image 
